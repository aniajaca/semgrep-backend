{"status":"success","engine":"semgrep","findings":[{"engine":"semgrep","ruleId":"javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","category":"security","severity":"MEDIUM","message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.","cwe":"CWE-352","owasp":["A01:2021 - Broken Access Control","A01:2025 - Broken Access Control"],"file":"/var/folders/_p/1xx1tjz57sn81bfv3y0rgyrc0000gn/T/neperia-wNoAAW/application.js","startLine":1,"endLine":1,"startColumn":40,"endColumn":53,"snippet":"   1: â†’ const express=require(\"express\");const app=express();app.get(\"/api/users\",(req,res)=>{res.json([]);});app.post(\"/api/data\",(req,res)=>{res.json({r:req.body.q});});app.listen(3000);","confidence":"LOW","impact":"HIGH","likelihood":"LOW","enrichedAt":"2026-02-26T15:47:11.737Z","cweId":"CWE-352","bts":5,"crs":50,"adjustedSeverity":"medium","priority":{"priority":"P2","action":"Fix in next sprint","sla":"2 weeks"},"context":{"internetFacing":true,"noAuth":true},"contextEvidence":{"internetFacing":{"confidence":0.9,"evidence":["Found route: app.get()","Found route: app.post()"]},"noAuth":{"confidence":0.5,"evidence":["No auth patterns found via regex"]}},"inferredFactors":["internetFacing","noAuth"],"appliedFactors":[],"remediation":{"priority":{"priority":"P2","action":"Fix in next sprint","sla":"2 weeks"},"timeline":"2 weeks - Include in next sprint","approach":"Review code and apply security best practices","validation":"Perform security testing","risk":"Potential security vulnerability","resources":{"documentation":"https://cwe.mitre.org/data/definitions/352.html","owaspGuide":"https://owasp.org/www-project-top-ten/","category":"Security Category: unknown"},"preventionMeasures":["Implement secure coding standards","Add security linting rules","Include security testing in CI/CD","Conduct regular security training","Perform periodic security audits"]},"sla":30}],"overallRisk":{"score":{"raw":8,"normalized":32,"multiplier":1,"final":8,"scale":"0-100"},"risk":{"level":"minimal","priority":{"level":"P4","action":"Monitor","timeframe":"90 days","description":"Track but no immediate action"},"confidence":0.5},"level":"minimal","priority":{"level":"P4","action":"Monitor","timeframe":"90 days","description":"Track but no immediate action"}},"summary":{"totalFindings":1,"severityDistribution":{"critical":0,"high":0,"medium":1,"low":0,"info":0},"contextFactorsDetected":["internetFacing","noAuth"],"top5":[{"file":"application.js","line":1,"cwe":"CWE-352","severity":"medium","crs":50,"priority":"P2","message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies."}]},"provenance":{"profileId":"default","profileHash":"a42dbec2ca96","profileVersion":"1.1.0","taxonomyVersion":"2.0.0","contextInferenceVersion":"1.0.0","timestamp":"2026-02-26T15:47:11.747Z","scanDuration":"11220ms","configuration":{"language":"javascript","engine":"semgrep","contextInferenceEnabled":true,"featuresEnabled":{"js":{"routes":true,"auth":true,"pii":true},"py":{"routes":true,"auth":true,"pii":true},"java":{"routes":true,"auth":true,"pii":true}}}}}