{"status":"success","engine":"semgrep","findings":[{"engine":"semgrep","ruleId":"javascript.lang.security.detect-child-process.detect-child-process","category":"security","severity":"CRITICAL","message":"Detected calls to child_process from a function argument `req`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ","cwe":"CWE-78","owasp":["A01:2017 - Injection","A03:2021 - Injection","A05:2025 - Injection"],"file":"/var/folders/_p/1xx1tjz57sn81bfv3y0rgyrc0000gn/T/neperia-lfjtLH/maintenance.js","startLine":1,"endLine":1,"startColumn":137,"endColumn":174,"snippet":"   1: → const express=require(\"express\");const{exec}=require(\"child_process\");const app=express();app.post(\"/internal/cleanup\",(req,res)=>{exec(\"systemctl restart \"+req.body.service,(e,o)=>{res.json({output:o});});});app.listen(8080);","confidence":"LOW","impact":"HIGH","likelihood":"LOW","enrichedAt":"2026-02-26T15:45:39.678Z","cweId":"CWE-78","bts":9,"crs":100,"adjustedSeverity":"critical","priority":{"priority":"P0","action":"Fix immediately","sla":"4 hours"},"context":{"internetFacing":true,"noAuth":true},"contextEvidence":{"internetFacing":{"confidence":0.9,"evidence":["Found route: app.post()"]},"noAuth":{"confidence":0.5,"evidence":["No auth patterns found via regex"]}},"inferredFactors":["internetFacing","noAuth"],"appliedFactors":["internetFacing"],"remediation":{"priority":{"priority":"P0","action":"Fix immediately","sla":"4 hours"},"timeline":"48 hours - High priority fix","approach":"Use parameterized queries, avoid dynamic command construction, validate all inputs","validation":"Test with injection payloads, use automated scanning tools, code review","risk":"Can lead to complete system compromise, data breach, or service disruption","resources":{"documentation":"https://cwe.mitre.org/data/definitions/78.html","owaspGuide":"https://owasp.org/www-project-top-ten/","category":"Security Category: injection"},"preventionMeasures":["Implement secure coding standards","Add security linting rules","Include security testing in CI/CD","Conduct regular security training","Perform periodic security audits"]},"sla":7},{"engine":"semgrep","ruleId":"javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","category":"security","severity":"MEDIUM","message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.","cwe":"CWE-352","owasp":["A01:2021 - Broken Access Control","A01:2025 - Broken Access Control"],"file":"/var/folders/_p/1xx1tjz57sn81bfv3y0rgyrc0000gn/T/neperia-lfjtLH/maintenance.js","startLine":1,"endLine":1,"startColumn":77,"endColumn":90,"snippet":"   1: → const express=require(\"express\");const{exec}=require(\"child_process\");const app=express();app.post(\"/internal/cleanup\",(req,res)=>{exec(\"systemctl restart \"+req.body.service,(e,o)=>{res.json({output:o});});});app.listen(8080);","confidence":"LOW","impact":"HIGH","likelihood":"LOW","enrichedAt":"2026-02-26T15:45:39.678Z","cweId":"CWE-352","bts":5,"crs":50,"adjustedSeverity":"medium","priority":{"priority":"P2","action":"Fix in next sprint","sla":"2 weeks"},"context":{"internetFacing":true,"noAuth":true},"contextEvidence":{"internetFacing":{"confidence":0.9,"evidence":["Found route: app.post()"]},"noAuth":{"confidence":0.5,"evidence":["No auth patterns found via regex"]}},"inferredFactors":["internetFacing","noAuth"],"appliedFactors":[],"remediation":{"priority":{"priority":"P2","action":"Fix in next sprint","sla":"2 weeks"},"timeline":"2 weeks - Include in next sprint","approach":"Review code and apply security best practices","validation":"Perform security testing","risk":"Potential security vulnerability","resources":{"documentation":"https://cwe.mitre.org/data/definitions/352.html","owaspGuide":"https://owasp.org/www-project-top-ten/","category":"Security Category: unknown"},"preventionMeasures":["Implement secure coding standards","Add security linting rules","Include security testing in CI/CD","Conduct regular security training","Perform periodic security audits"]},"sla":30}],"overallRisk":{"score":{"raw":33,"normalized":66,"multiplier":1,"final":33,"scale":"0-100"},"risk":{"level":"low","priority":{"level":"P3","action":"Schedule later","timeframe":"30 days","description":"Add to technical debt backlog"},"confidence":0.6},"level":"low","priority":{"level":"P3","action":"Schedule later","timeframe":"30 days","description":"Add to technical debt backlog"}},"summary":{"totalFindings":2,"severityDistribution":{"critical":1,"high":0,"medium":1,"low":0,"info":0},"contextFactorsDetected":["internetFacing","noAuth"],"top5":[{"file":"maintenance.js","line":1,"cwe":"CWE-78","severity":"critical","crs":100,"priority":"P0","message":"Detected calls to child_process from a function argument `req`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. "},{"file":"maintenance.js","line":1,"cwe":"CWE-352","severity":"medium","crs":50,"priority":"P2","message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies."}]},"provenance":{"profileId":"default","profileHash":"a42dbec2ca96","profileVersion":"1.1.0","taxonomyVersion":"2.0.0","contextInferenceVersion":"1.0.0","timestamp":"2026-02-26T15:45:39.695Z","scanDuration":"13144ms","configuration":{"language":"javascript","engine":"semgrep","contextInferenceEnabled":true,"featuresEnabled":{"js":{"routes":true,"auth":true,"pii":true},"py":{"routes":true,"auth":true,"pii":true},"java":{"routes":true,"auth":true,"pii":true}}}}}