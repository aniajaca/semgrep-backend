{
    "status": "success",
    "engine": "semgrep",
    "findings": [
        {
            "engine": "semgrep",
            "ruleId": "javascript.lang.security.detect-child-process.detect-child-process",
            "category": "security",
            "severity": "CRITICAL",
            "message": "Detected calls to child_process from a function argument `req`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ",
            "cwe": "CWE-78",
            "owasp": [
                "A01:2017 - Injection",
                "A03:2021 - Injection"
            ],
            "file": "Evaluation/04_risk_scoring/test_files/production_api_backup.js",
            "startLine": 17,
            "endLine": 17,
            "startColumn": 8,
            "endColumn": 15,
            "snippet": "requires login",
            "confidence": "LOW",
            "impact": "HIGH",
            "likelihood": "LOW",
            "enrichedAt": "2026-01-02T12:17:41.985Z",
            "cweId": "CWE-78",
            "bts": 9,
            "crs": 100,
            "adjustedSeverity": "critical",
            "priority": {
                "priority": "P0",
                "action": "Fix immediately",
                "sla": "4 hours"
            },
            "context": {
                "internetFacing": true,
                "production": true,
                "handlesPI": true
            },
            "contextEvidence": {},
            "inferredFactors": [],
            "appliedFactors": [
                "internetFacing",
                "handlesPI",
                "production"
            ],
            "remediation": {
                "priority": {
                    "priority": "P0",
                    "action": "Fix immediately",
                    "sla": "4 hours"
                },
                "timeline": "Immediate - Emergency patch required",
                "approach": "Use parameterized queries, avoid dynamic command construction, validate all inputs",
                "validation": "Test with injection payloads, use automated scanning tools, code review",
                "risk": "Can lead to complete system compromise, data breach, or service disruption",
                "resources": {
                    "documentation": "https://cwe.mitre.org/data/definitions/78.html",
                    "owaspGuide": "https://owasp.org/www-project-top-ten/",
                    "category": "Security Category: injection"
                },
                "preventionMeasures": [
                    "Implement secure coding standards",
                    "Add security linting rules",
                    "Include security testing in CI/CD",
                    "Conduct regular security training",
                    "Perform periodic security audits"
                ]
            },
            "sla": 7
        }
    ],
    "overallRisk": {
        "score": {
            "raw": 25,
            "normalized": 100,
            "multiplier": 2.7299999999999995,
            "final": 68.2,
            "scale": "0-100"
        },
        "risk": {
            "level": "high",
            "priority": {
                "level": "P1",
                "action": "Fix this week",
                "timeframe": "48-72 hours",
                "description": "Schedule urgent remediation"
            },
            "confidence": 0.6
        },
        "level": "high",
        "priority": {
            "level": "P1",
            "action": "Fix this week",
            "timeframe": "48-72 hours",
            "description": "Schedule urgent remediation"
        }
    },
    "summary": {
        "totalFindings": 1,
        "severityDistribution": {
            "critical": 1,
            "high": 0,
            "medium": 0,
            "low": 0,
            "info": 0
        },
        "contextFactorsDetected": [],
        "top5": [
            {
                "file": "production_api_backup.js",
                "line": 17,
                "cwe": "CWE-78",
                "severity": "critical",
                "crs": 100,
                "priority": "P0",
                "message": "Detected calls to child_process from a function argument `req`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. "
            }
        ]
    },
    "provenance": {
        "profileId": "default",
        "profileHash": "caca9f04ff44",
        "profileVersion": "1.1.0",
        "taxonomyVersion": "2.0.0",
        "contextInferenceVersion": "1.0.0",
        "timestamp": "2026-01-02T12:17:41.988Z",
        "scanDuration": "11226ms",
        "configuration": {
            "language": "javascript",
            "engine": "semgrep",
            "contextInferenceEnabled": true,
            "featuresEnabled": {
                "js": {
                    "routes": true,
                    "auth": true,
                    "pii": true
                },
                "py": {
                    "routes": true,
                    "auth": true,
                    "pii": true
                },
                "java": {
                    "routes": true,
                    "auth": true,
                    "pii": true
                }
            }
        }
    }
}
