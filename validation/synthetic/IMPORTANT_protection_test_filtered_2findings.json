{"status":"success","engine":"semgrep","findings":[{"engine":"semgrep","ruleId":"java.lang.security.audit.formatted-sql-string.formatted-sql-string","category":"security","severity":"CRITICAL","message":"Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use a prepared statements (java.sql.PreparedStatement) instead. You can obtain a PreparedStatement using 'connection.prepareStatement'.","cwe":"CWE-89","owasp":["A01:2017 - Injection","A03:2021 - Injection","A05:2025 - Injection"],"file":"/Users/aniajaca/Desktop/semgreg-backend-local/validation/synthetic/src/api/UnsafeUserService.java","startLine":12,"endLine":14,"startColumn":20,"endColumn":6,"snippet":"   9:       \n  10:       // VULNERABLE: String concatenation in SQL\n  11:       Statement stmt = conn.createStatement();\n  12: →     ResultSet rs = stmt.executeQuery(\n  13: →         \"SELECT * FROM users WHERE id = '\" + userId + \"'\"\n  14: →     );\n  15:       // ... process results\n  16:       return null;\n  17:   }","confidence":"MEDIUM","impact":"MEDIUM","likelihood":"HIGH","enrichedAt":"2026-02-16T13:49:41.463Z","cweId":"CWE-89","bts":9,"crs":100,"adjustedSeverity":"critical","priority":{"priority":"P0","action":"Fix immediately","sla":"4 hours"},"context":{"internetFacing":true,"noAuth":true},"contextEvidence":{"internetFacing":{"confidence":0.4,"evidence":["Path suggests controller: /Users/aniajaca/Desktop/semgreg-backend-local/validation/synthetic/src/api/UnsafeUserService.java"]},"noAuth":{"confidence":0.5,"evidence":["No auth patterns detected"]}},"inferredFactors":["internetFacing","noAuth"],"appliedFactors":["internetFacing"],"remediation":{"priority":{"priority":"P0","action":"Fix immediately","sla":"4 hours"},"timeline":"48 hours - High priority fix","approach":"Use parameterized queries, avoid dynamic command construction, validate all inputs","validation":"Test with injection payloads, use automated scanning tools, code review","risk":"Can lead to complete system compromise, data breach, or service disruption","resources":{"documentation":"https://cwe.mitre.org/data/definitions/89.html","owaspGuide":"https://owasp.org/www-project-top-ten/","category":"Security Category: injection"},"preventionMeasures":["Implement secure coding standards","Add security linting rules","Include security testing in CI/CD","Conduct regular security training","Perform periodic security audits"]},"sla":7},{"engine":"semgrep","ruleId":"java.lang.security.audit.xss.no-direct-response-writer.no-direct-response-writer","category":"security","severity":"HIGH","message":"Detected a request with potential user-input going into a OutputStream or Writer object. This bypasses any view or template environments, including HTML escaping, which may expose this application to cross-site scripting (XSS) vulnerabilities. Consider using a view technology such as JavaServer Faces (JSFs) which automatically escapes HTML views.","cwe":"CWE-79","owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection","A05:2025 - Injection"],"file":"/Users/aniajaca/Desktop/semgreg-backend-local/validation/synthetic/src/web/UnsafeRenderer.java","startLine":10,"endLine":10,"startColumn":5,"endColumn":71,"snippet":"   7:       String username = request.getParameter(\"name\");\n   8:       \n   9:       // VULNERABLE: No encoding\n  10: →     response.getWriter().println(\"<h1>Welcome, \" + username + \"</h1>\");\n  11:   }\n  12:   }\n  13:   ","confidence":"MEDIUM","impact":"MEDIUM","likelihood":"HIGH","enrichedAt":"2026-02-16T13:49:41.463Z","cweId":"CWE-79","bts":7.5,"crs":75,"adjustedSeverity":"high","priority":{"priority":"P1","action":"Fix within 48 hours","sla":"48 hours"},"context":{"noAuth":true},"contextEvidence":{"noAuth":{"confidence":0.5,"evidence":["No auth patterns detected"]}},"inferredFactors":["noAuth"],"appliedFactors":[],"remediation":{"priority":{"priority":"P1","action":"Fix within 48 hours","sla":"48 hours"},"timeline":"48 hours - High priority fix","approach":"Encode output, implement CSP, validate and sanitize input","validation":"XSS testing with various payloads, browser security testing","risk":"Client-side attacks, session hijacking, data theft, defacement","resources":{"documentation":"https://cwe.mitre.org/data/definitions/79.html","owaspGuide":"https://owasp.org/www-project-top-ten/","category":"Security Category: xss"},"preventionMeasures":["Implement secure coding standards","Add security linting rules","Include security testing in CI/CD","Conduct regular security training","Perform periodic security audits"]},"sla":14}],"overallRisk":{"score":{"raw":40,"normalized":80,"multiplier":1,"final":40,"scale":"0-100"},"risk":{"level":"medium","priority":{"level":"P2","action":"Plan in sprint","timeframe":"2 weeks","description":"Include in next development cycle"},"confidence":0.6},"level":"medium","priority":{"level":"P2","action":"Plan in sprint","timeframe":"2 weeks","description":"Include in next development cycle"}},"summary":{"totalFindings":2,"severityDistribution":{"critical":1,"high":1,"medium":0,"low":0,"info":0},"contextFactorsDetected":["internetFacing","noAuth"],"top5":[{"file":"UnsafeUserService.java","line":12,"cwe":"CWE-89","severity":"critical","crs":100,"priority":"P0","message":"Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use a prepared statements (java.sql.PreparedStatement) instead. You can obtain a PreparedStatement using 'connection.prepareStatement'."},{"file":"UnsafeRenderer.java","line":10,"cwe":"CWE-79","severity":"high","crs":75,"priority":"P1","message":"Detected a request with potential user-input going into a OutputStream or Writer object. This bypasses any view or template environments, including HTML escaping, which may expose this application to cross-site scripting (XSS) vulnerabilities. Consider using a view technology such as JavaServer Faces (JSFs) which automatically escapes HTML views."}]},"provenance":{"profileId":"default","profileHash":"a42dbec2ca96","profileVersion":"1.1.0","taxonomyVersion":"2.0.0","contextInferenceVersion":"1.0.0","timestamp":"2026-02-16T13:49:41.482Z","scanDuration":"11949ms","configuration":{"language":"java","engine":"semgrep","contextInferenceEnabled":true,"featuresEnabled":{"js":{"routes":true,"auth":true,"pii":true},"py":{"routes":true,"auth":true,"pii":true},"java":{"routes":true,"auth":true,"pii":true}}}}}